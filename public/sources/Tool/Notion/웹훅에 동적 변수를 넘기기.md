---
created: 2024-12-31 10:25
updated: 2024-12-31 10:58
tags:
  - Notion/WebHook
  - Notion/Automation
  - 노션/웹훅
  - 노션/자동화
---
업무 관리를 위한 자동화 템플릿을 작성하던 중 동적 변수 처리에서 난관에 봉착했다.
버튼 클릭 시 페이지를 생성하고, 페이지를 생성한 사용자를 판별해 웹훅을 동작시키고 싶었는데, 노션의 웹훅이 오직 정적인 헤더만을 지원하는 것이 문제였다.

동적인 값을 넘길 방법을 찾다가, 자동화 과정을 2-step으로 나누면 문제를 해결할 수 있다는 것을 알게 되었다.
관련 아이디어는 [이 페이지](https://www.simonesmerilli.com/life/webhook-notion)에서 얻었으며, 웹훅을 동적으로 호출하는 방법을 여기에 정리해보려고 한다.
# 첫 번째 스텝, 페이지 생성
먼저 페이지 생성을 자동화할 버튼을 추가하자.
DB 뷰나 여러 페이지에 대한 네비게이션이 위치한 상위 페이지에 버튼을 생성하면 된다.
![[페이지_생성_버튼.png|250]]
이 버튼의 역할은 아주 단순하다.
타겟 데이터베이스에 새로운 페이지를 추가하고, 해당 페이지를 오픈하는 역할을 한다.
# 두 번째 스텝, 동적 변수를 담은 웹훅 호출
열린 페이지가 속한 DB에 버튼 프로퍼티를 추가하거나, 템플릿으로 Content 영역에 버튼을 추가하자.
개인적으로 템플릿 버튼은 버튼이 삭제될 수 있기 때문에 프로퍼티를 선호한다.
![[페이지_프로퍼티.png|200]]

페이지 내부의 버튼 동작 시에는 페이지의 프로퍼티 값을 웹훅 엔드포인트의 Content에 담아 보낼 수 있다.
![[웹훅_호출_버튼.png|300]]

사용하는 자동화 도구에서 body 영역을 확인하면 전송된 프로퍼티를 볼 수 있다.
![[웹훅_바디.png|200]]

프로퍼티를 참조해서 원하는 대로 동적인 웹훅을 작성하면 된다.